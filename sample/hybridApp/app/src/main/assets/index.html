<!DOCTYPE html>
<html>
<head>
    <title>Dfinery Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://unpkg.com/mvp.css">
    <style>
        .container{
            width: 100%;
        }
        .column{
            width: 100%;
        }
        button {
            display: block;
            margin: 5px 0;
            width: 100%;
            box-sizing: border-box;
        }
    </style>
    <!--html에 script를 추가하는 방법-->
<!--   <script src="./dfinery-html-bridge.js" defer></script>-->
</head>
<body class="markdown-body">
<div class="container">
    <div class="category">
        <div class="column">
            <h2>LogEvent</h2>
            <button onclick="Login()">Login</button>
            <button onclick="Purchase()">Purchase</button>
            <button onclick="CustomEvent()">Custom Event</button>
            <h2>UserProfile</h2>
            <button onclick="setUserProfile()">setUserProfile</button>
            <button onclick="setUserProfiles()">setUserProfiles</button>
            <h2>Identity</h2>
            <button onclick="setIdentity()">setIdentity</button>
            <button onclick="setIdentities()">setIdentities</button>
        </div>
    </div>
</div>
<script>
    function Login() {
        dfineryBridge.logEvent(DFEvent.LOGIN);
        console.log("Login 함수가 호출되었습니다.");
    }
    function CustomEvent() {
        const now = new Date();
        const formattedDate = toUtcIsoString(now);
        const param = {
            "custom_property_1": 34000,
            "custom_property_2": 42.195,
            "custom_property_3": "Seoul",
            "custom_property_4": true,
            "custom_property_5": formattedDate,
            "custom_property_6": "1999-01-01",
            "custom_property_7": [20, 30, 40],
            "custom_property_8": [1.1, 1.2, 1.3],
            "custom_property_9": ["Hello", "World"]
        };
        dfineryBridge.logEvent('custom_event', param);
        console.log("Custom Event 함수가 호출되었습니다.");
    }
    function Purchase() {
        const item = {
            [DFEventProperty.ITEM_ID]: "상품번호",
            [DFEventProperty.ITEM_NAME]: "상품이름",
            [DFEventProperty.ITEM_CATEGORY1]: "식품",
            [DFEventProperty.ITEM_CATEGORY2]: "과자",
            [DFEventProperty.ITEM_PRICE]: 5000.0,
            [DFEventProperty.ITEM_DISCOUNT]: 500.0,
            [DFEventProperty.ITEM_QUANTITY]: 5
        }
        const items = [item];
        const param = {
            [DFEventProperty.ITEMS]: items,
            [DFEventProperty.ORDER_ID]: "주문번호",
            [DFEventProperty.PAYMENT_METHOD]: "BankTransfer",
            [DFEventProperty.TOTAL_PURCHASE_AMOUNT]: 25500.0,
            [DFEventProperty.DELIVERY_CHARGE]: 3000.0,
            [DFEventProperty.DISCOUNT]:0
        };
        dfineryBridge.logEvent(DFEvent.PURCHASE, param);
        console.log("Purchase 함수가 호출되었습니다.");
    }
    function setUserProfile() {
        dfineryBridge.setUserProfile(DFUserProfile.NAME, 'Tester');
        console.log("setUserProfile 함수가 호출되었습니다.");
    }
    function setUserProfiles() {
        const now = new Date();
        const formattedDate = toUtcIsoString(now);
        const param = {
            [DFUserProfile.GENDER]: DFGender.FEMALE,
            [DFUserProfile.BIRTH]: "1999-01-01",
            [DFUserProfile.MEMBERSHIP]: "VIP",
            [DFUserProfile.PUSH_ADS_OPTIN]: true,
            [DFUserProfile.SMS_ADS_OPTIN]: false,
            [DFUserProfile.KAKAO_ADS_OPTIN]: true,
            [DFUserProfile.PUSH_NIGHT_ADS_OPTIN]: false,

            "custom_user_profile_1": 34000,
            "custom_user_profile_2": 42.195,
            "custom_user_profile_3": formattedDate,
            "custom_user_profile_4": [20, 30],
            "custom_user_profile_5": [1.1, 1.2],
            "custom_user_profile_6": ["Hello", "World"]
        };
        dfineryBridge.setUserProfiles(param);
        console.log("setUserProfiles 함수가 호출되었습니다.");
    }
    function setIdentity() {
        dfineryBridge.setIdentity(DFIdentity.EXTERNAL_ID, 'user_a1b2c3d4');
        console.log("setIdentity 함수가 호출되었습니다.");
    }
    function setIdentities() {
        const param = {
            [DFIdentity.EMAIL]: 'sample.user@example.com',
            [DFIdentity.PHONE_NO]: '821012345678',
            [DFIdentity.KAKAO_USER_ID]: 'kakao_u98765',
            [DFIdentity.LINE_USER_ID]: 'line_i10293'
        };
        dfineryBridge.setIdentities(param);
        console.log("setIdentities 함수가 호출되었습니다.");
    }
    function toUtcIsoString(dateObj) {
        if (!(dateObj instanceof Date) || isNaN(dateObj.getTime())) {
            return "Invalid Date";
        }
        return dateObj.toISOString();
    }
    </script>
</body>
</html>
